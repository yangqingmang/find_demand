# 市场分析主工具

**文件名**: `market_analyzer.py`

## 功能概述

市场分析主工具整合了所有单独的分析组件，提供一站式市场需求分析解决方案。它可以自动执行完整的分析流程，从数据采集到最终报告生成，大大提高了分析效率。

## 使用方法

### 基本用法

```bash
python market_analyzer.py --keywords "ai tools" --geo "US"
```

### 参数说明

- `--keywords`：要分析的关键词列表（必需）
- `--geo`：地区代码，如US、GB等，默认为全球
- `--timeframe`：时间范围，默认为过去3个月（today 3-m）
- `--output`：输出目录，默认为data
- `--volume-weight`：搜索量权重，默认0.4
- `--growth-weight`：增长率权重，默认0.4
- `--kd-weight`：关键词难度权重，默认0.2
- `--min-score`：最低评分过滤
- `--no-enrich`：不丰富关键词数据

### 输出说明

工具会在指定的输出目录（默认为`data`）生成以下文件：

1. `trends_all_YYYY-MM-DD.csv`：Google Trends数据
2. `scored_YYYY-MM-DD.csv`：关键词评分结果
3. `scored_high_score_YYYY-MM-DD.csv`：高分关键词（分数>=70）
4. `intent_YYYY-MM-DD.csv`：搜索意图分析结果
5. `intent_summary_YYYY-MM-DD.json`：意图分析摘要
6. `intent_I/N/C/E/B_YYYY-MM-DD.csv`：按意图分组的关键词
7. `analysis_report_YYYY-MM-DD.json`：综合分析报告
8. `analysis_log_YYYY-MM-DD.txt`：分析日志

## 技术细节

### 分析流程

1. **数据采集**：使用 `TrendsCollector` 获取 Google Trends 数据
2. **关键词评分**：使用 `KeywordScorer` 对关键词进行评分和排序
3. **意图分析**：使用 `IntentAnalyzer` 分析关键词的搜索意图
4. **报告生成**：整合所有结果，生成综合分析报告

### 代码结构

```python
class MarketAnalyzer:
    def __init__(self, output_dir='data'):
        # 初始化设置和组件
        
    def log(self, message):
        # 记录日志
        
    def run_analysis(self, keywords, geo='', timeframe='today 3-m', 
                    volume_weight=0.4, growth_weight=0.4, kd_weight=0.2,
                    min_score=None, enrich=True):
        # 运行完整的市场需求分析流程
```

## 示例输出

### 终端输出

```
[2025-08-04 16:49:22] 开始市场需求分析 - 关键词: ['ai tools'] 地区: US
[2025-08-04 16:49:22] 步骤1: 获取Google Trends数据
正在获取 'ai tools' 的Rising Queries数据 (地区: US)...
成功获取 25 个Rising Queries
[2025-08-04 16:49:27] 已保存Google Trends数据到: data\trends_all_2025-08-04.csv
[2025-08-04 16:49:27] 步骤2: 关键词评分
[2025-08-04 16:49:27] 正在丰富关键词数据...
模拟获取Google Ads数据...
已添加模拟的Ads数据到 25 个关键词
[2025-08-04 16:49:27] 已保存评分结果到: data\scored_2025-08-04.csv
[2025-08-04 16:49:27] 步骤3: 搜索意图分析
[2025-08-04 16:49:27] 已保存意图分析结果到: data\intent_2025-08-04.csv
[2025-08-04 16:49:27] 已保存意图分析摘要到: data\intent_summary_2025-08-04.json
[2025-08-04 16:49:27] 已保存分析报告到: data\analysis_report_2025-08-04.json

分析完成!
总耗时: 5.23 秒
关键词总数: 25

意图分布:
  I (Informational): 76.0%
  C (Commercial): 20.0%
  E (Transactional): 4.0%

Top5高分关键词:
  1. what is the term for unauthorized use of ai tools by employees without their employer's permission? (分数: 50, 意图: I)
  2. best ai seo tools 2025 (分数: 22, 意图: C)
  3. ai tools for ecommerce (分数: 14, 意图: I)
  4. claude code (分数: 14, 意图: I)
  5. ai automation tools (分数: 13, 意图: I)
```

### 分析报告（JSON）

```json
{
  "分析日期": "2025-08-04",
  "分析关键词": ["ai tools"],
  "地区": "US",
  "时间范围": "today 3-m",
  "分析耗时(秒)": 5.23,
  "关键词总数": 25,
  "高分关键词数": 0,
  "意图分布": {
    "I": 76.0,
    "C": 20.0,
    "E": 4.0,
    "N": 0.0,
    "B": 0.0
  },
  "Top5关键词": [
    {"query": "what is the term for unauthorized use of ai tools by employees without their employer's permission?", "score": 50, "intent": "I"},
    {"query": "best ai seo tools 2025", "score": 22, "intent": "C"},
    {"query": "ai tools for ecommerce", "score": 14, "intent": "I"},
    {"query": "claude code", "score": 14, "intent": "I"},
    {"query": "ai automation tools", "score": 13, "intent": "I"}
  ],
  "输出文件": {
    "Google Trends数据": "data\\trends_all_2025-08-04.csv",
    "评分结果": "data\\scored_2025-08-04.csv",
    "意图分析结果": "data\\intent_2025-08-04.csv",
    "意图分析摘要": "data\\intent_summary_2025-08-04.json"
  }
}
```

## 注意事项

- 完整分析可能需要一些时间，特别是处理多个关键词时
- 如果某个步骤失败，后续步骤可能会受到影响
- 模拟数据仅供演示，实际应用中应使用真实数据源

## 未来改进

- 添加更多数据源和分析维度
- 实现可视化报告和仪表盘
- 添加定时任务调度功能
- 支持更复杂的分析场景和自定义流程
- 添加结果导出为其他格式（PDF、Excel等）